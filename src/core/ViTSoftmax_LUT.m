function output = ViTSoftmax_LUT(input, dim, MathType)

    exp_lut=[...
0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,11,11,11,12,12,13,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,21,21,22,23,23,24,25,26,27,27,28,29,30,31,32,33,34,35,36,37,39,40,41,42,44,45,47,48,50,51,53,55,56,58,60,62,64,66,68,70,72,75,77,79,82,84,87,90,93,96,99,102,105,108,112,115,119,123,127,131,135,139,144,148,153,158,163,168,173,179,185,190,196,203,209,216,223,230,237,245,252,260,269,277,286,295,304,314,324,334,345,356,367,379,391,403,416,429,443,457,471,486,502,518,534,551,568,587,605,624,644,665,686,708,730,753,777,802,827,853,880,908,937,967,998,1029,1062,1096,1131,1166,1203,1242,1281,1322,1364,1407,1452,1498,1545,1594,1645,1697,1751,1807,1864,1923,1984,2047,2112,2179,2248,2320,2393,2469,2548,2629,2712,2798,2887,2979,3073,3171,3271,3375,3482,3593,3707,3825,3946,4071,4201,4334,4472,4613,4760,4911,5067,5228,5394,5565,5742,5924,6112,6306,6506,6713,6926,7145,7372,7606,7848,8097,8354,8619,8893,9175,9466,9767,10077,10397,10727,11067,11418,11781,12155,12541,12939,13350,13773,14211,14662,15127,15607,16103,16614,17141,17685,18247,18826,19423,20040,20676,21333,22010,22708,23429,24173,24940,25732,26549,27391,28261,29158,30084,31039,32024,33040,34089,35171,36288,37440,38628,39854,41120,42425,43771,45161,46595,48074,49600,51174,52798,54474,56204,57988,59829,61728,63687,65709,67795,69947,72167,74458,76821,79260,81776,84372,87050,89813,92664,95606,98641,101772,105002,108335,111774,115323,118983,122760,126657,130678,134826,139106,143521,148077,152778,157627,162631,167793,173120,178615,184285,190135,196170,202397,208822,215451,222290,229346,236626,244138,251888,259883,268133,276644,285426,294486,303834,313479,323430,333697,344289,355218,366494,378128,390131,402515,415292,428475,442076,456109,470588,485526,500938,516840,533246,550173,567637,585656,604247,623428,643217,663635,684701,706436,728861,751997,775868,800497,825907,852125,879174,907082,935876,965584,996235,1027858,1060486,1094150,1128882,1164716,1201688,1239834,1279190,1319796,1361691,1404916,1449513,1495525,1542998,1591978,1642513,1694652,1748446,1803948,1861211,1920292,1981249,2044141,2109028,2175976,2245049,2316315,...
2389842,2465704,2543974,2624728,2708046,2794009,2882700,2974207,3068618,3166027,3266527,3370218,3477200,3587578,3701460,3818957,3940184,4065259,...
4194303];
    
    input = single(input);
    
    % Retrieves the maximum value of the specified dimension
    maxVals = max(input, [], dim);
    
    % Subtracts the maximum value from the specified dimension
    shiftedInput = input - maxVals;

    DataType  = numerictype('Signed',1, 'WordLength', 12, 'FractionLength', 5);

    q_shiftedInput = fi(shiftedInput,DataType,MathType);

    q_shiftedInput_Int = storedInteger(q_shiftedInput);

    for i = 1:numel(q_shiftedInput_Int)
        if(q_shiftedInput_Int(i) < -512)
            q_shiftedInput_Int(i) = -512;
        end
    end

    for i = 1:numel(q_shiftedInput_Int)
        expVals_Int(i) = exp_lut(q_shiftedInput_Int(i)+512+1);
        expVals(i) = expVals_Int(i)*power(2,-5);
    end

    expVals = reshape(expVals,size(q_shiftedInput_Int));
    
    % Calculating index values
    % expVals = exp(shiftedInput);
    
    % Sum over the specified dimension
    sumExp = sum(expVals, dim);
    
    % Dividing by the sum yields the softmax result
    output = expVals ./ sumExp;
end
